<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>

  <form method="post" action="{% url 'registrations' %}" id="registerForm">
    {% csrf_token %}
    <p>
      <label for="id_registration_id_0">
        Choose registration to be PWA enabled
      </label>
    </p>
    {% if registrations %}
      <ul>
        {% for registration in registrations %}
          <li>
            <label for="id_registration_id_0" data-msgid="{{ registration.name }}">
              <input
                type="radio"
                name="slug"
                value="{{ registration.slug }}"
                id="slug_id"
                {% if registration.is_pwa_enabled %} checked {% endif %}
              >
              {{ registration.name }}
            </label>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <h3>There is no active registrations right now...</h3>
    {% endif %}
    <button type="submit">Send</button>
  </form>

<script>
  const cacheName = "v1";
  const button = document.querySelector("button");

  button.addEventListener("submit", event => {
      event.preventDefault();

      const slug = document.getElementById("slug_id").value
      if (slug) {
          caches.open(cacheName).then(cache => {
              cache.add(`/en-us/register/${slug}/1/`);
              console.log("Form url added to cache");
          });
      }

      document.getElementById("registerForm").submit();
  });
</script>
</body>
</html>